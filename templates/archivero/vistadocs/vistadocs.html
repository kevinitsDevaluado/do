{% extends 'dashboard/paneladministracion.html' %}
 
{%load static%}

{% block title %}
Listar Años Temas
{% endblock title %}

{% block extracss %} 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.2.1/themes/default/style.min.css" />

{% endblock extracss %} 


{% block menuleft %}
    <div class="left-menu">
            <div class="menubar-content">
                <nav class="animated bounceInDown">
                    <ul id="sidebar">
                        <li class="active">
                            <a href="{% url 'administrador:paneladministracion' %}"> <i class="fas fa-home"></i>REGRESAR AE-UTC</a>
                        </li>
                  
                        <li>
                            <a href="{% url 'archivero:inicio_documentos' %}"> <i class="fa-solid fa-group-arrows-rotate"></i>Regresar al Archivero</a>
                        </li>
                        
                       

                        <li>
                            <a href="{% url 'logout' %}"> <i class="fas fa-sign-out-alt"></i>CERRAR SESIÓN</a>
                        </li>
                    </ul>
                </nav>
            </div>
    </div>
{% endblock menuleft %}



{% block main %}

<div  id="loading-screen"  > </div>
<style>
    #loading-screen {
        position: fixed;
        left: 0px;
        top: 0px;
        width: 100%;
        height: 100%;
        z-index: 9999;
        background: url('/static/assets/gif/gif3.gif') 50% 50% no-repeat rgb(249,249,249);
        opacity: .8;
    }
</style>
<div class="all-admin my-5">
    <div class="container-fluid">





        <div class="row">
            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 mb-4 ">
                <button class="btn-crud h-100 w-100" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample2" aria-expanded="false" aria-controls="collapseExample">
                        <div class="card border-left-danger shadow h-100 py-2 rounded-pill">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">
                                            Agregar Nueva Relación AÑO/TEMA (Archivero)
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-add earn-icon wallet fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                </button>
            </div>
            <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 mb-4 ">
                <button class="btn-crud h-100 w-100" type="button" data-bs-toggle="collapse" data-bs-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
                        <div class="card border-left-danger shadow h-100 py-2 rounded-pill">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">
                                            Listar  Relación AÑO/TEMA (Archivero)
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-list earn-icon wallet fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                </button>
            </div>    
            
            
        </div>
        <div class="row">
            <div class="collapse  mb-2" id="collapseExample2" >

                <div class="card card-body">
                    <h4 class="text-center" > Seleccione el año y la carpeta que desea crear</h4><br>
                    <form action="" method="get" class="row ">
                        <div class="col-md-12  text-center mt-4 mb-4">
                            <div class="row">
                                <div class="col-lg-6 col-md-6 col-sm-6 mb-4 ">
                                    <a href="{% url 'archivero:inicio_anios' %}" class="btn btn-primary w-50  rounded-pill me-4" ><i class="fa-solid fa-folder-plus"></i> Años</a>

                                </div>
                                <div class=" col-lg-6 col-md-6 col-sm-6  ">
                                    <a href="{% url 'archivero:inicio_temas' %}" class="btn btn-primary w-50  rounded-pill " ><i class="fa-solid fa-folder-plus"></i> Temas</a>
                                </div>
                            </div>
                        </div>
                    
                        {% if messages %}
                            {% for message in messages %}
                                <div class="alert {{ message.tags }} alert-dismissible fade show" role="alert">
                                    {{ message }}
                                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                                </div>
                            {% endfor %}
                        {% endif %}
                        {% if join and join2 %}
                            <div class="col-md-6 col-sm-6 mb-4 text-center align-self-center justify-content-center">
                                <div class="row">
                                    <div class="col-xl-2 col-lg-2 col-md-2 "></div>
                                    <div class="col-xl-9 col-lg-9 col-md-9 ">
                                        
                                        <select name="enviar4" class="form-select" aria-label="Default select example" >
                                            <option selected value="">Seleccione el año</option>
                                            {% for inner in join  %}
                                            <option value="{{ inner.0}}">   {{ inner.1}}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                    <div class="col-xl-1 col-lg-1 col-md-1 "></div>
                                </div>
                            </div>
                            <div class="col-md-6 col-sm-6 ">
                                <div class="row">
                                    <div class="col-xl-8 col-lg-8 col-md-8 mb-2">
                                        {% for inner2 in join2  %}
                                        <div class="form-check okey">
                                            <input class="form-check-input" type="checkbox" name="enviar3" value="{{inner2.0}}" id="flexCheckDefault">
                                            <label class="form-check-label" for="flexCheckDefault">
                                                <img src="{% static './assets/images/folder2.png' %}" alt="" class="icon"> {{inner2.1}}
                                            </label>
                                        </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12 text-center mt-4">
                                <button type="submit"  class="btn btn-outline-primary" >Registrar </button>
                            </div>
                        {%else%}
                            <div class="container-fluid w-75">
                                <h5  class="text-center mt-4 mb-4 p-4 border border-dark rounded-pill" > Seccion habilitada cuando este creado una carpeta de año y tema como mínimo </h5>
                            </div>
                                        
                        {%endif%}
                                    
                    </form>
                </div>
            </div>

            <div class="collapse" id="collapseExample">
                <div class="card card-body">
                   
                   <div class="col-md-12 col-sm-12">
                       <div class="order-list">
                           <p class="order-ac-title">Listado de Años Temas</p>
                           <div class="data-table-section table-responsive">
                               <table id="tabla_aniostema_archivero" class="table table-striped dt-responsive nowrap" cellspacing="0" style="width:100%">
                                   <thead>
                                       <tr>
                                           <th>#</th>
                                           <th>AÑO</th>
                                           <th>TEMA</th>
                                            <th>OPCIONES</th>
                                       </tr>
                                   </thead>
                                   <tbody class="order-view-tb">
                                   </tbody>
                               </table>
                           </div>
                       </div>
                   </div>


                </div>
            </div>
        </div>
            

        
                    
    </div>
</div>


<div class="modal fade" id="editar" role="dialog"></div>

<div class="modal fade" id="eliminar" role="dialog"></div>


{% endblock main %}

{% block extrajs %} 

<script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.2.1/jstree.min.js"></script>
<script>
    $(function () {
        $("#jstree_demo").jstree({
          "types" : {
            "default" : {
              "icon" : "bi bi-folder text-primary"
          },
          "file" : {
            "icon" : "bi-filetype-pdf",
          },
          "demo" : {
            "icon" : "bi-filetype-pdf"
          }
        },
          "plugins" : ["search", "types", "wholerow","conditionalselect"],
        });
      });
</script>
<script src="{% static 'assets/js/archivero/aniotemas/index.js' %}"></script>



<script>
            
    $(document).ready(function(){
        var screen = $('#loading-screen');
        configureLoadingScreen(screen);

        $('.do-request').on('click',function(){
            $.get(response)
                .done(function(result){
                    $().text(JSON.stringify(result,null,2));

    
                })
                .fail(function(error){
                    console.error(error);
                })
            
        })                          



    });
    function configureLoadingScreen(screen){
        $(document)
            .ajaxStart(function(){
                screen.fadeIn();
            })
            .ajaxStop(function(){
                screen.fadeOut();
            });
            }


</script>

{% endblock extrajs %} 
